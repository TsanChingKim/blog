{{ $password := .Get "password" }}
{{ $content := .Inner }}

<div class="password-protected">
  <div class="password-form" id="password-form-{{ .Ordinal }}">
    <h3>🔒 此内容受密码保护</h3>
    <p>请输入密码查看内容：</p>
    <input type="password" id="password-input-{{ .Ordinal }}" placeholder="请输入密码">
    <button onclick="checkPassword({{ .Ordinal }}, '{{ $password }}')">验证密码</button>
    <div class="error-message" id="error-{{ .Ordinal }}" style="display: none; color: red; margin-top: 10px;">
      密码错误，请重试
    </div>
  </div>
  
  <div class="protected-content" id="content-{{ .Ordinal }}" style="display: none;">
    {{ $content | markdownify }}
  </div>
</div>

<script>
function checkPassword(ordinal, correctPassword) {
  const input = document.getElementById('password-input-' + ordinal);
  const form = document.getElementById('password-form-' + ordinal);
  const content = document.getElementById('content-' + ordinal);
  const error = document.getElementById('error-' + ordinal);
  
  if (input.value === correctPassword) {
    form.style.display = 'none';
    content.style.display = 'block';
  } else {
    error.style.display = 'block';
    input.value = '';
    setTimeout(() => {
      error.style.display = 'none';
    }, 3000);
  }
}
</script>

<style>
.password-protected {
  margin: 20px 0;
  padding: 20px;
  border: 2px solid #ff6b6b;
  border-radius: 10px;
  background: rgba(255, 107, 107, 0.1);
}

.password-form {
  text-align: center;
}

.password-form input {
  padding: 10px;
  margin: 10px;
  border: 1px solid #ddd;
  border-radius: 5px;
  width: 200px;
}

.password-form button {
  padding: 10px 20px;
  background: #ff6b6b;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.password-form button:hover {
  background: #ff5252;
}

.protected-content {
  margin-top: 20px;
  padding: 20px;
  background: rgba(0, 255, 136, 0.1);
  border-radius: 10px;
  border: 2px solid #00ff88;
}
</style>
